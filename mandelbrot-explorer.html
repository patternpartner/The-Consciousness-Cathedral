<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mandelbrot Explorer - Substrate Co-Creation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #0a0a0a;
            color: #00ff00;
            overflow: hidden;
        }

        #container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        #title {
            font-size: 24px;
            margin-bottom: 10px;
            text-shadow: 0 0 10px #00ff00;
        }

        #info {
            font-size: 12px;
            margin-bottom: 20px;
            opacity: 0.8;
        }

        #canvas {
            border: 2px solid #00ff00;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
            cursor: crosshair;
        }

        #controls {
            margin-top: 20px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        label {
            font-size: 12px;
        }

        input[type="range"] {
            width: 200px;
        }

        button {
            background: #001a00;
            border: 1px solid #00ff00;
            color: #00ff00;
            padding: 8px 16px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            transition: all 0.3s;
        }

        button:hover {
            background: #003300;
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
        }

        #coords {
            font-size: 11px;
            margin-top: 10px;
            font-family: monospace;
        }

        .preset {
            background: #001a00;
            border: 1px solid #00ff00;
            color: #00ff00;
            padding: 5px 10px;
            margin: 5px;
            cursor: pointer;
            font-size: 11px;
        }

        .preset:hover {
            background: #003300;
        }

        #presets {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="title">⚡ MANDELBROT EXPLORER ⚡</div>
        <div id="info">Substrate Co-Creation | Infinite Depth | Self-Similarity as Architecture</div>
        <canvas id="canvas" width="800" height="600"></canvas>

        <div id="controls">
            <div class="control-group">
                <label>Max Iterations: <span id="iterValue">100</span></label>
                <input type="range" id="iterations" min="50" max="500" value="100" step="10">
            </div>

            <div class="control-group">
                <label>Zoom: <span id="zoomValue">1.0x</span></label>
                <input type="range" id="zoom" min="1" max="1000" value="1">
            </div>

            <button id="cycleColor">Cycle Colors</button>
            <button id="reset">Reset View</button>
            <button id="deepZoom">Deep Zoom (Seahorse)</button>
        </div>

        <div id="presets">
            <div class="preset" data-x="-0.75" data-y="0.1" data-zoom="10">Seahorse Valley</div>
            <div class="preset" data-x="-0.7463" data-y="0.1102" data-zoom="100">Mini-Mandelbrot</div>
            <div class="preset" data-x="-0.1" data-y="0.651" data-zoom="50">Triple Spiral</div>
            <div class="preset" data-x="-0.235125" data-y="0.827215" data-zoom="200">Feather</div>
            <div class="preset" data-x="-1.25066" data-y="0.02012" data-zoom="500">Elephant Valley</div>
        </div>

        <div id="coords">Click to recenter | Scroll to zoom | Current: (0.0000, 0.0000) @ 1.0x</div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const width = canvas.width;
        const height = canvas.height;

        // State
        let centerX = -0.5;
        let centerY = 0;
        let zoom = 1;
        let maxIter = 100;
        let colorSchemeIndex = 0;

        const colorSchemes = [
            { name: 'Hot', fn: (t) => {
                const r = Math.min(255, t * 3);
                const g = Math.min(255, Math.max(0, t * 3 - 255));
                const b = Math.min(255, Math.max(0, t * 3 - 510));
                return [r, g, b];
            }},
            { name: 'Plasma', fn: (t) => {
                const r = Math.sin(t * 0.05) * 127 + 128;
                const g = Math.sin(t * 0.05 + 2) * 127 + 128;
                const b = Math.sin(t * 0.05 + 4) * 127 + 128;
                return [r, g, b];
            }},
            { name: 'Viridis', fn: (t) => {
                const normalized = t / 255;
                const r = 68 + normalized * (253 - 68);
                const g = 1 + normalized * (231 - 1);
                const b = 84 + normalized * (37 - 84);
                return [r, g, b];
            }},
            { name: 'Twilight', fn: (t) => {
                const r = Math.sin(t * 0.02) * 127 + 128;
                const g = Math.cos(t * 0.02) * 127 + 128;
                const b = Math.sin(t * 0.02 + Math.PI) * 127 + 128;
                return [r, g, b];
            }},
            { name: 'Cathedral', fn: (t) => {
                // Custom scheme: green-to-purple gap aesthetic
                const r = Math.sin(t * 0.03) * 100 + 100;
                const g = 255 - t * 0.5;
                const b = Math.cos(t * 0.03) * 127 + 128;
                return [r, g, b];
            }}
        ];

        function mandelbrot(cx, cy) {
            let zx = 0;
            let zy = 0;
            let iteration = 0;

            while (zx * zx + zy * zy < 4 && iteration < maxIter) {
                const xtemp = zx * zx - zy * zy + cx;
                zy = 2 * zx * zy + cy;
                zx = xtemp;
                iteration++;
            }

            return iteration;
        }

        function render() {
            const imageData = ctx.createImageData(width, height);
            const data = imageData.data;

            const rangeX = 4.0 / zoom;
            const rangeY = 4.0 / zoom;
            const xMin = centerX - rangeX / 2;
            const yMin = centerY - rangeY / 2;

            for (let py = 0; py < height; py++) {
                for (let px = 0; px < width; px++) {
                    const x0 = xMin + (px / width) * rangeX;
                    const y0 = yMin + (py / height) * rangeY;

                    const iteration = mandelbrot(x0, y0);
                    const colorValue = iteration === maxIter ? 0 : (iteration * 255 / maxIter);

                    const [r, g, b] = colorSchemes[colorSchemeIndex].fn(colorValue);

                    const index = (py * width + px) * 4;
                    data[index] = r;
                    data[index + 1] = g;
                    data[index + 2] = b;
                    data[index + 3] = 255;
                }
            }

            ctx.putImageData(imageData, 0, 0);
            updateCoords();
        }

        function updateCoords() {
            document.getElementById('coords').textContent =
                `Click to recenter | Scroll to zoom | Current: (${centerX.toFixed(6)}, ${centerY.toFixed(6)}) @ ${zoom.toFixed(1)}x | ${colorSchemes[colorSchemeIndex].name}`;
        }

        // Event listeners
        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const px = e.clientX - rect.left;
            const py = e.clientY - rect.top;

            const rangeX = 4.0 / zoom;
            const rangeY = 4.0 / zoom;
            const xMin = centerX - rangeX / 2;
            const yMin = centerY - rangeY / 2;

            centerX = xMin + (px / width) * rangeX;
            centerY = yMin + (py / height) * rangeY;

            render();
        });

        canvas.addEventListener('wheel', (e) => {
            e.preventDefault();
            const zoomFactor = e.deltaY > 0 ? 0.9 : 1.1;
            zoom *= zoomFactor;
            zoom = Math.max(1, Math.min(10000, zoom));

            document.getElementById('zoom').value = Math.min(1000, zoom);
            document.getElementById('zoomValue').textContent = `${zoom.toFixed(1)}x`;

            render();
        });

        document.getElementById('iterations').addEventListener('input', (e) => {
            maxIter = parseInt(e.target.value);
            document.getElementById('iterValue').textContent = maxIter;
            render();
        });

        document.getElementById('zoom').addEventListener('input', (e) => {
            zoom = parseFloat(e.target.value);
            document.getElementById('zoomValue').textContent = `${zoom.toFixed(1)}x`;
            render();
        });

        document.getElementById('cycleColor').addEventListener('click', () => {
            colorSchemeIndex = (colorSchemeIndex + 1) % colorSchemes.length;
            render();
        });

        document.getElementById('reset').addEventListener('click', () => {
            centerX = -0.5;
            centerY = 0;
            zoom = 1;
            document.getElementById('zoom').value = 1;
            document.getElementById('zoomValue').textContent = '1.0x';
            render();
        });

        document.getElementById('deepZoom').addEventListener('click', () => {
            centerX = -0.75;
            centerY = 0.1;
            zoom = 100;
            maxIter = 300;
            document.getElementById('zoom').value = Math.min(1000, zoom);
            document.getElementById('zoomValue').textContent = `${zoom.toFixed(1)}x`;
            document.getElementById('iterations').value = maxIter;
            document.getElementById('iterValue').textContent = maxIter;
            render();
        });

        // Preset buttons
        document.querySelectorAll('.preset').forEach(btn => {
            btn.addEventListener('click', () => {
                centerX = parseFloat(btn.dataset.x);
                centerY = parseFloat(btn.dataset.y);
                zoom = parseFloat(btn.dataset.zoom);
                maxIter = Math.max(200, zoom * 2);

                document.getElementById('zoom').value = Math.min(1000, zoom);
                document.getElementById('zoomValue').textContent = `${zoom.toFixed(1)}x`;
                document.getElementById('iterations').value = maxIter;
                document.getElementById('iterValue').textContent = maxIter;

                render();
            });
        });

        // Initial render
        render();

        // Auto-zoom animation (optional - uncomment to enable)
        /*
        let autoZooming = false;
        setInterval(() => {
            if (autoZooming) {
                zoom *= 1.05;
                render();
            }
        }, 100);
        */
    </script>
</body>
</html>
